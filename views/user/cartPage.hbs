<div class="row">
    <div class="cartContent">
        <div class="cartHead">CART</div>
        <div id="cart">
        </div>
        <div class="nextPartOrder">
            <div class="saveOfOrder">YOU SAVE: <span style="color: red;"><b>50% </b></span>OFF</div>
            <div class="grandTotal" id="total-price">GRAND TOTAL:</div> <br>
            <div class="expireCart" id="countdown"></div>
            <button class="updateBtn">UPDATE</button>
            <span style="display: flex;">
                <a id="pay-button" style="margin-right: 10px"></a>
                <a id="paypal-button"></a>
            </span>
        </div>
    </div>
</div>
<script>
var timeLeft = 1000;
var downloadTimer = setInterval(function() {
    if (timeLeft <= 0) {
        clearInterval(downloadTimer);
        document.getElementById('countdown').innerHTML = 'Finished';
    } else {
        document.getElementById('countdown').innerHTML = 'The cart will expire in: ' + timeLeft;
    }
    timeLeft -= 1;
}, 1000);



showCartElement();
var selectedPeopleAmount = null;
var selectedBakcground = null;

var addToCart = document.getElementById('add-to-cart');

addToCart.addEventListener('click', function(event) {
    if (selectedPeopleAmount != null) {

        var localStorageCart = JSON.parse(localStorage.getItem("cart"));

        if (localStorageCart == null) {
            localStorageCart = [];
        }

        localStorageCart.push({
            selectedPeople: selectedPeopleAmount,
            selectedBakcground: selectedBakcground
        });

        localStorage.setItem("cart", JSON.stringify(localStorageCart));
        showCartElement();
    }
});

var peopleAmountImages = document.getElementsByClassName("people-amount-image");

for (var i = 0; i < peopleAmountImages.length; i++) {
    peopleAmountImages[i].addEventListener('click', function(event) {
        for (var j = 0; j < peopleAmountImages.length; j++) {
            peopleAmountImages[j].className = "people-amount-image";
        }

        var price = Number(event.target.getAttribute('data-price'));
        var id = event.target.getAttribute('data-id');

        event.target.className += " people-amount-image-clicked";

        selectedPeopleAmount = {
            id: id,
            price: price
        };
    });
}


var backgroundImage = document.getElementsByClassName("background-image");

for (var i = 0; i < backgroundImage.length; i++) {
    backgroundImage[i].addEventListener('click', function(event) {
        for (var j = 0; j < backgroundImage.length; j++) {
            backgroundImage[j].className = "background-image";
        }

        var price = Number(event.target.getAttribute('data-price'));
        var id = event.target.getAttribute('data-id');
        var name = event.target.getAttribute('name');


        event.target.className += " people-amount-image-clicked";

        selectedBakcground = {
            id: id,
            price: price,
            name: name
        };
    });
}

function getItemTemplate(numPpl, bgName, price, text, image) {
    return '<div class="orderDetails">' +
        '<div class="namberOfOrder"><b>0000</b></div>' +
        '<div class="orderPhoto"><img src="' + image + '"></div>' +
        '<div class="details">' +
        '<div class="hOrder">Original Dream Portrait Art</div>' +
        '<div class="numberOfPeopleOrder">Number of people:<b> ' + numPpl + '</b></div>' +
        '<div class="backgroundOrder">Background: ' + bgName + '</div>' +
        '<div class="noteOrder">Note: ' + text + '</div>' +
        '<div class="priceOrder">Price:  <b><del>' + price * 2 + '  </del>' + price + '</b></div>' +
        '</div>' +
        '<div class="price-Order"><b>$' + price + ' </b></div>' +
        '<button class="deleteOrder" onclick="ClearData()"><img src="/images/container.png" alt=""></button>' +
        '</div>';


};




function showCartElement() {
    var localStorageCart = JSON.parse(localStorage.getItem("cart"));
    var totalPrice = 0;

    if (!localStorageCart) {
        return;
    }

    var shoppingCart = document.getElementById('cart');
    shoppingCart.innerHTML = '';

    for (var i = 0; i < localStorageCart.length; i++) {
        var item = localStorageCart[i];
        totalPrice += item.selectedPeople.price;

        if (item.selectedBakcground != null) {
            totalPrice += item.selectedBakcground.price;
        }

        if (item.selectedBakcground != null) {
            shoppingCart.innerHTML += getItemTemplate(item.selectedPeople.id, item.selectedBakcground.name, item.selectedPeople.price, item.wishesText, item.image);
        } else {
            shoppingCart.innerHTML +=
                "<li>People: " + item.selectedPeople.id + " - $" + item.selectedPeople.price + "</li>";
        }
    }

    var totalPriceElement = document.getElementById('total-price');
    totalPriceElement.innerHTML = 'GRAND TOTAL:<b> $' + totalPrice + '</b>';
}
</script>
<script>
var localStorageCart = JSON.parse(localStorage.getItem("cart"));
var totalPrice = 0;

if (localStorageCart) {
    for (var i = 0; i < localStorageCart.length; i++) {
        var item = localStorageCart[i];
        totalPrice += item.selectedPeople.price;

        if (item.selectedBakcground != null) {
            totalPrice += item.selectedBakcground.price;
        }
    }
    const payButtonBlock = document.getElementById("pay-button");
    const script = document.createElement('script');
    script.setAttribute('src', '//checkout.stripe.com/v2/checkout.js');
    script.setAttribute('class', 'stripe-button');
    script.setAttribute('data-key', 'pk_test_51HUukXJCfuIg3Y2YIdIhomHB9Y1h78cTGrcNUA9V9ZkpX4FmkIhoMtzsPoXQv6hpuOsMVRmLO7yc3v36MBZGfnaa00BOyrTPLV');
    script.setAttribute('data-description', 'Sample payment');
    script.setAttribute('data-amount', totalPrice * 100);

    payButtonBlock.appendChild(script);
}
</script>